name: Release

on:
  push:
    tags:
      - "v*.*.*"

jobs:
  release:
    runs-on: windows-latest
    steps:
     - name: Checkout source
       uses: actions/checkout@v4
      
     - name: Setup .NET
       uses: actions/setup-dotnet@v4
       with:
         dotnet-version: '8.x.x'

     - name: Build
       run: dotnet build --configuration Release
        
     - name: Rename
       run: Rename-Item -Path ./Mikoto/bin/Release/net8.0-windows/win-x64 -NewName mikoto-x64
     - name: Zip the Build
       run: Compress-Archive -Path ./Mikoto/bin/Release/net8.0-windows/mikoto-x64 -Destination mikoto-x64.zip 
        
     - name: Create Release and Upload Release Asset
       uses: softprops/action-gh-release@v2
       with:
          tag_name: ${{ github.ref }}
          name: Release ${{ github.ref }}
          body: TODO New Release.
          draft: false
          prerelease: false
          files: mikoto-x64.zip
